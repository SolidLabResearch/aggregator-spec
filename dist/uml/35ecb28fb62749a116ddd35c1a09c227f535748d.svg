<?plantuml 1.2026.1?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="414px" preserveAspectRatio="none" style="width:966px;height:414px;background:#FFFFFF;" version="1.1" viewBox="0 0 966 414" width="966px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="133.6641" style="stroke:#000000;stroke-width:1.5;" width="744.3101" x="216.1089" y="228.0938"/><g class="participant-lifeline" data-entity-uid="part1" data-qualified-name="User" id="part1-lifeline"><g><title>User .</title><rect fill="#000000" fill-opacity="0.00000" height="342.4609" width="8" x="30.3809" y="36.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="34" x2="34" y1="36.2969" y2="378.7578"/></g></g><g class="participant-lifeline" data-entity-uid="part2" data-qualified-name="Client" id="part2-lifeline"><g><title>Client ...</title><rect fill="#000000" fill-opacity="0.00000" height="342.4609" width="8" x="260.0005" y="36.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="263.1089" x2="263.1089" y1="36.2969" y2="378.7578"/></g></g><g class="participant-lifeline" data-entity-uid="part3" data-qualified-name="Aggregator" id="part3-lifeline"><g><title>Aggregator Server .</title><rect fill="#000000" fill-opacity="0.00000" height="342.4609" width="8" x="590.8906" y="36.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="594.7866" x2="594.7866" y1="36.2969" y2="378.7578"/></g></g><g class="participant-lifeline" data-entity-uid="part4" data-qualified-name="IDP" id="part4-lifeline"><g><title>IDP .</title><rect fill="#000000" fill-opacity="0.00000" height="342.4609" width="8" x="921.3174" y="36.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="925.2158" x2="925.2158" y1="36.2969" y2="378.7578"/></g></g><g class="participant participant-head" data-entity-uid="part1" data-qualified-name="User" id="part1-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="58.7617" x="5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.7617" x="12" y="24.9951">User &#128587;</text></g><g class="participant participant-tail" data-entity-uid="part1" data-qualified-name="User" id="part1-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="58.7617" x="5" y="377.7578"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.7617" x="12" y="397.7529">User &#128587;</text></g><g class="participant participant-head" data-entity-uid="part2" data-qualified-name="Client" id="part2-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="75.7832" x="226.1089" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61.7832" x="233.1089" y="24.9951">Client &#129489;&#8205;&#128187;</text></g><g class="participant participant-tail" data-entity-uid="part2" data-qualified-name="Client" id="part2-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="75.7832" x="226.1089" y="377.7578"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61.7832" x="233.1089" y="397.7529">Client &#129489;&#8205;&#128187;</text></g><g class="participant participant-head" data-entity-uid="part3" data-qualified-name="Aggregator" id="part3-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="156.208" x="516.7866" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142.208" x="523.7866" y="24.9951">Aggregator Server &#129302;</text></g><g class="participant participant-tail" data-entity-uid="part3" data-qualified-name="Aggregator" id="part3-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="156.208" x="516.7866" y="377.7578"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142.208" x="523.7866" y="397.7529">Aggregator Server &#129302;</text></g><g class="participant participant-head" data-entity-uid="part4" data-qualified-name="IDP" id="part4-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="50.2031" x="900.2158" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.2031" x="907.2158" y="24.9951">IDP &#128272;</text></g><g class="participant participant-tail" data-entity-uid="part4" data-qualified-name="IDP" id="part4-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="50.2031" x="900.2158" y="377.7578"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.2031" x="907.2158" y="397.7529">IDP &#128272;</text></g><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg1"><polygon fill="#181818" points="582.8906,63.4297,592.8906,67.4297,582.8906,71.4297,586.8906,67.4297" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="264.0005" x2="588.8906" y1="67.4297" y2="67.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163.8838" x="271.0005" y="62.3638">1. Start device_code flow</text></g><g class="message" data-entity-1="part3" data-entity-2="part4" id="msg2"><polygon fill="#181818" points="913.3174,92.5625,923.3174,96.5625,913.3174,100.5625,917.3174,96.5625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="594.8906" x2="919.3174" y1="96.5625" y2="96.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="213.3765" x="601.8906" y="91.4966">1.1 Device authorization request</text></g><g class="message" data-entity-1="part4" data-entity-2="part3" id="msg3"><polygon fill="#181818" points="605.8906,121.6953,595.8906,125.6953,605.8906,129.6953,601.8906,125.6953" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="599.8906" x2="924.3174" y1="125.6953" y2="125.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="306.4268" x="611.8906" y="120.6294">1.2 device_code + user_code + verification_uri</text></g><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg4"><polygon fill="#181818" points="275.0005,150.8281,265.0005,154.8281,275.0005,158.8281,271.0005,154.8281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="269.0005" x2="593.8906" y1="154.8281" y2="154.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="306.8901" x="281.0005" y="149.7622">1.3 Return state + user_code + verification_uri</text></g><g class="message" data-entity-1="part2" data-entity-2="part1" id="msg5"><polygon fill="#181818" points="45.3809,179.9609,35.3809,183.9609,45.3809,187.9609,41.3809,183.9609" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="39.3809" x2="263.0005" y1="183.9609" y2="183.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.6196" x="51.3809" y="178.895">2. Show code + verification URI</text></g><g class="message" data-entity-1="part1" data-entity-2="part4" id="msg6"><polygon fill="#181818" points="913.3174,209.0938,923.3174,213.0938,913.3174,217.0938,917.3174,213.0938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="34.3809" x2="919.3174" y1="213.0938" y2="213.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.5693" x="41.3809" y="208.0278">3. Authorize device</text></g><path d="M216.1089,228.0938 L292.7329,228.0938 L292.7329,235.2266 L282.7329,245.2266 L216.1089,245.2266 L216.1089,228.0938" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="133.6641" style="stroke:#000000;stroke-width:1.5;" width="744.3101" x="216.1089" y="228.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="31.624" x="231.1089" y="241.1606">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="223.2441" x="307.7329" y="240.3042">[Polling until authorized or expired]</text><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg7"><polygon fill="#181818" points="582.8906,262.3594,592.8906,266.3594,582.8906,270.3594,586.8906,266.3594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="264.0005" x2="588.8906" y1="266.3594" y2="266.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.3291" x="271.0005" y="261.2935">4. Poll with state</text></g><g class="message" data-entity-1="part3" data-entity-2="part4" id="msg8"><polygon fill="#181818" points="913.3174,291.4922,923.3174,295.4922,913.3174,299.4922,917.3174,295.4922" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="594.8906" x2="919.3174" y1="295.4922" y2="295.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163.4331" x="601.8906" y="290.4263">4.1 Redeem device_code</text></g><g class="message" data-entity-1="part4" data-entity-2="part3" id="msg9"><polygon fill="#181818" points="605.8906,320.625,595.8906,324.625,605.8906,328.625,601.8906,324.625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="599.8906" x2="924.3174" y1="324.625" y2="324.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="109.0781" x="611.8906" y="319.5591">pending / tokens</text></g><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg10"><polygon fill="#181818" points="275.0005,349.7578,265.0005,353.7578,275.0005,357.7578,271.0005,353.7578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="269.0005" x2="593.8906" y1="353.7578" y2="353.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="191.9722" x="281.0005" y="348.6919">202 Accepted or 201 Created</text></g><?plantuml-src XL71Ji905BplLxpqQa0ed3YO4Bnm8n3EPDC-oePbjsvVGJrvDoPgZ8adBYP-X7_Z5_09lYr5smZnqkxcpSoRcSsMogJIoHNmbrIaKcbeGZSQmM54qYGQXQZCO9gX0vb1K1nssxVxe3OVQ8NyyuZokDj-F7tTFUospvzrQD1F4eU99EjWWcvTwBs_1fxyEwfJXfSZ1hqy5Y2-255kQLnKE3reDs52J8GOroh2MMHZXBcs6r5PoXoMyE0sN1Oua3ajh5EtafGrtC5LZXa9lxNnPqDO4p-3d1ivd3cCcgkea9dbJjNMijBUjLVfm1WfTmOoalIlJ2MkVu0UX1nqOJTmX03JyL0KptG8scb2lmo8fNaXjBKfZApMoYIG6rBwfmMCWVtYTQeSnYUQxZOBCcmKBVOPZbNSvOh762EkggKTBJP54tihvq1sYIOxLLtO2g4VHPZItcROQiF08Hk81Kjy0m00?></g></svg>
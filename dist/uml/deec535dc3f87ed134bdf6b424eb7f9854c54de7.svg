<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="458px" preserveAspectRatio="none" style="width:1153px;height:458px;" version="1.1" viewBox="0 0 1153 458" width="1153px" zoomAndPan="magnify"><defs><filter height="300%" id="f2kk2flxq5tjq" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="39" x2="39" y1="38.2969" y2="417.8906"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="118" x2="118" y1="38.2969" y2="417.8906"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="326" x2="326" y1="38.2969" y2="417.8906"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="484" x2="484" y1="38.2969" y2="417.8906"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="813" x2="813" y1="38.2969" y2="417.8906"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="1023" x2="1023" y1="38.2969" y2="417.8906"/><rect fill="#FEFECE" filter="url(#f2kk2flxq5tjq)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="8" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="15" y="22.9951">User &#128587;</text><rect fill="#FEFECE" filter="url(#f2kk2flxq5tjq)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="58" x="8" y="416.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="44" x="15" y="436.8857">User &#128587;</text><rect fill="#FEFECE" filter="url(#f2kk2flxq5tjq)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="73" x="80" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="59" x="87" y="22.9951">Client &#129489;‚Äç&#128187;</text><rect fill="#FEFECE" filter="url(#f2kk2flxq5tjq)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="73" x="80" y="416.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="59" x="87" y="436.8857">Client &#129489;‚Äç&#128187;</text><rect fill="#FEFECE" filter="url(#f2kk2flxq5tjq)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="49" x="300" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="35" x="307" y="22.9951">IDP &#128272;</text><rect fill="#FEFECE" filter="url(#f2kk2flxq5tjq)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="49" x="300" y="416.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="35" x="307" y="436.8857">IDP &#128272;</text><rect fill="#FEFECE" filter="url(#f2kk2flxq5tjq)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="239" x="363" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="225" x="370" y="22.9951">Application Client ID Document &#128196;</text><rect fill="#FEFECE" filter="url(#f2kk2flxq5tjq)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="239" x="363" y="416.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="225" x="370" y="436.8857">Application Client ID Document &#128196;</text><rect fill="#FEFECE" filter="url(#f2kk2flxq5tjq)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="151" x="736" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="137" x="743" y="22.9951">Aggregator Server &#129302;</text><rect fill="#FEFECE" filter="url(#f2kk2flxq5tjq)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="151" x="736" y="416.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="137" x="743" y="436.8857">Aggregator Server &#129302;</text><rect fill="#FEFECE" filter="url(#f2kk2flxq5tjq)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="241" x="901" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="227" x="908" y="22.9951">Aggregator Client ID Document &#128196;</text><rect fill="#FEFECE" filter="url(#f2kk2flxq5tjq)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="241" x="901" y="416.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="227" x="908" y="436.8857">Aggregator Client ID Document &#128196;</text><polygon fill="#A80036" points="801.5,65.4297,811.5,69.4297,801.5,73.4297,805.5,69.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="118.5" x2="807.5" y1="69.4297" y2="69.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="179" x="125.5" y="64.3638">1. Start aggregator creation</text><polygon fill="#A80036" points="129.5,94.5625,119.5,98.5625,129.5,102.5625,125.5,98.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="123.5" x2="812.5" y1="98.5625" y2="98.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="173" x="135.5" y="93.4966">1.1 Return flow parameters</text><polygon fill="#A80036" points="314.5,123.6953,324.5,127.6953,314.5,131.6953,318.5,127.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="118.5" x2="320.5" y1="127.6953" y2="127.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="125.5" y="122.6294">2. Redirect to IDP login</text><polygon fill="#A80036" points="337.5,152.8281,327.5,156.8281,337.5,160.8281,333.5,156.8281" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="1011.5,152.8281,1021.5,156.8281,1011.5,160.8281,1015.5,156.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="331.5" x2="1017.5" y1="156.8281" y2="156.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="307" x="343.5" y="151.7622">2.1 Dereference Aggregator Client ID Document</text><polygon fill="#A80036" points="50,181.9609,40,185.9609,50,189.9609,46,185.9609" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="314.5,181.9609,324.5,185.9609,314.5,189.9609,318.5,185.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="44" x2="320.5" y1="185.9609" y2="185.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="56" y="180.895">3. Authenticate and consent</text><polygon fill="#A80036" points="129.5,211.0938,119.5,215.0938,129.5,219.0938,125.5,215.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="123.5" x2="325.5" y1="215.0938" y2="215.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="135.5" y="210.0278">4. Redirect with code + state</text><polygon fill="#A80036" points="801.5,240.2266,811.5,244.2266,801.5,248.2266,805.5,244.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="118.5" x2="807.5" y1="244.2266" y2="244.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="236" x="125.5" y="239.1606">5. Return code + redirect_uri + state</text><polygon fill="#A80036" points="495.5,269.3594,485.5,273.3594,495.5,277.3594,491.5,273.3594" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="801.5,269.3594,811.5,273.3594,801.5,277.3594,805.5,273.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="489.5" x2="807.5" y1="273.3594" y2="273.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="305" x="501.5" y="268.2935">5.1 Dereference Application Client ID Document</text><path d="M736,286.3594 L736,311.3594 L887,311.3594 L887,296.3594 L877,286.3594 L736,286.3594 " fill="#FBFB77" filter="url(#f2kk2flxq5tjq)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M877,286.3594 L877,296.3594 L887,296.3594 L877,286.3594 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="742" y="303.4263">validate redirect_uri.</text><polygon fill="#A80036" points="337.5,337.625,327.5,341.625,337.5,345.625,333.5,341.625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="331.5" x2="812.5" y1="341.625" y2="341.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="112" x="343.5" y="336.5591">5.2 Redeem code</text><polygon fill="#A80036" points="801.5,366.7578,811.5,370.7578,801.5,374.7578,805.5,370.7578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="326.5" x2="807.5" y1="370.7578" y2="370.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="249" x="333.5" y="365.6919">IDP_aggregator_token + refresh_token</text><polygon fill="#A80036" points="129.5,395.8906,119.5,399.8906,129.5,403.8906,125.5,399.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="123.5" x2="812.5" y1="399.8906" y2="399.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="242" x="135.5" y="394.8247">5.3 Return aggregator account details</text><!--MD5=[244ce3a774ffc6d51fde7c895c27b7d9]
@startuml
skinparam participantStyle rectangle

participant User as "User üôã"
participant Client as "Client üßë‚Äçüíª"
participant "IDP üîê" as IDP
participant "Application Client ID Document üìÑ" as AppClientDoc
participant "Aggregator Server ü§ñ" as Aggregator
participant "Aggregator Client ID Document üìÑ" as AggregatorClientDoc

Client -> Aggregator: 1. Start aggregator creation
Aggregator - -> Client: 1.1 Return flow parameters

Client -> IDP: 2. Redirect to IDP login
IDP <-> AggregatorClientDoc: 2.1 Dereference Aggregator Client ID Document
IDP <-> User: 3. Authenticate and consent
IDP - -> Client: 4. Redirect with code + state

Client -> Aggregator: 5. Return code + redirect_uri + state
Aggregator <-> AppClientDoc: 5.1 Dereference Application Client ID Document
note over Aggregator: validate redirect_uri.
Aggregator -> IDP: 5.2 Redeem code
IDP - -> Aggregator: IDP_aggregator_token + refresh_token

Aggregator - -> Client: 5.3 Return aggregator account details
@enduml

PlantUML version 1.2020.02(Sun Mar 01 10:22:07 UTC 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 21.0.10+7-Debian-1deb13u1
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>
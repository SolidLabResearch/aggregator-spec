<?plantuml 1.2026.1?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="447px" preserveAspectRatio="none" style="width:1162px;height:447px;background:#FFFFFF;" version="1.1" viewBox="0 0 1162 447" width="1162px" zoomAndPan="magnify"><defs/><g><g class="participant-lifeline" data-entity-uid="part1" data-qualified-name="User" id="part1-lifeline"><g><title>User .</title><rect fill="#000000" fill-opacity="0.00000" height="375.5938" width="8" x="30.3809" y="36.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="34" x2="34" y1="36.2969" y2="411.8906"/></g></g><g class="participant-lifeline" data-entity-uid="part2" data-qualified-name="Client" id="part2-lifeline"><g><title>Client ...</title><rect fill="#000000" fill-opacity="0.00000" height="375.5938" width="8" x="107.6533" y="36.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="110.7617" x2="110.7617" y1="36.2969" y2="411.8906"/></g></g><g class="participant-lifeline" data-entity-uid="part3" data-qualified-name="IDP" id="part3-lifeline"><g><title>IDP .</title><rect fill="#000000" fill-opacity="0.00000" height="375.5938" width="8" x="321.9561" y="36.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="325.8545" x2="325.8545" y1="36.2969" y2="411.8906"/></g></g><g class="participant-lifeline" data-entity-uid="part4" data-qualified-name="AppClientDoc" id="part4-lifeline"><g><title>Application Client ID Document .</title><rect fill="#000000" fill-opacity="0.00000" height="375.5938" width="8" x="480.2549" y="36.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="484.0576" x2="484.0576" y1="36.2969" y2="411.8906"/></g></g><g class="participant-lifeline" data-entity-uid="part5" data-qualified-name="Aggregator" id="part5-lifeline"><g><title>Aggregator Server .</title><rect fill="#000000" fill-opacity="0.00000" height="375.5938" width="8" x="817.7085" y="36.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="821.6045" x2="821.6045" y1="36.2969" y2="411.8906"/></g></g><g class="participant-lifeline" data-entity-uid="part6" data-qualified-name="AggregatorClientDoc" id="part6-lifeline"><g><title>Aggregator Client ID Document .</title><rect fill="#000000" fill-opacity="0.00000" height="375.5938" width="8" x="1029.396" y="36.2969"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="1032.8125" x2="1032.8125" y1="36.2969" y2="411.8906"/></g></g><g class="participant participant-head" data-entity-uid="part1" data-qualified-name="User" id="part1-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="58.7617" x="5" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.7617" x="12" y="24.9951">User &#128587;</text></g><g class="participant participant-tail" data-entity-uid="part1" data-qualified-name="User" id="part1-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="58.7617" x="5" y="410.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="44.7617" x="12" y="430.8857">User &#128587;</text></g><g class="participant participant-head" data-entity-uid="part2" data-qualified-name="Client" id="part2-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="75.7832" x="73.7617" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61.7832" x="80.7617" y="24.9951">Client &#129489;&#8205;&#128187;</text></g><g class="participant participant-tail" data-entity-uid="part2" data-qualified-name="Client" id="part2-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="75.7832" x="73.7617" y="410.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61.7832" x="80.7617" y="430.8857">Client &#129489;&#8205;&#128187;</text></g><g class="participant participant-head" data-entity-uid="part3" data-qualified-name="IDP" id="part3-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="50.2031" x="300.8545" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.2031" x="307.8545" y="24.9951">IDP &#128272;</text></g><g class="participant participant-tail" data-entity-uid="part3" data-qualified-name="IDP" id="part3-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="50.2031" x="300.8545" y="410.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.2031" x="307.8545" y="430.8857">IDP &#128272;</text></g><g class="participant participant-head" data-entity-uid="part4" data-qualified-name="AppClientDoc" id="part4-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="246.3945" x="361.0576" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="232.3945" x="368.0576" y="24.9951">Application Client ID Document &#128196;</text></g><g class="participant participant-tail" data-entity-uid="part4" data-qualified-name="AppClientDoc" id="part4-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="246.3945" x="361.0576" y="410.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="232.3945" x="368.0576" y="430.8857">Application Client ID Document &#128196;</text></g><g class="participant participant-head" data-entity-uid="part5" data-qualified-name="Aggregator" id="part5-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="156.208" x="743.6045" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142.208" x="750.6045" y="24.9951">Aggregator Server &#129302;</text></g><g class="participant participant-tail" data-entity-uid="part5" data-qualified-name="Aggregator" id="part5-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="156.208" x="743.6045" y="410.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="142.208" x="750.6045" y="430.8857">Aggregator Server &#129302;</text></g><g class="participant participant-head" data-entity-uid="part6" data-qualified-name="AggregatorClientDoc" id="part6-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="247.167" x="909.8125" y="5"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="233.167" x="916.8125" y="24.9951">Aggregator Client ID Document &#128196;</text></g><g class="participant participant-tail" data-entity-uid="part6" data-qualified-name="AggregatorClientDoc" id="part6-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="247.167" x="909.8125" y="410.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="233.167" x="916.8125" y="430.8857">Aggregator Client ID Document &#128196;</text></g><g class="message" data-entity-1="part2" data-entity-2="part5" id="msg1"><polygon fill="#181818" points="809.7085,63.4297,819.7085,67.4297,809.7085,71.4297,813.7085,67.4297" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="111.6533" x2="815.7085" y1="67.4297" y2="67.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182.3428" x="118.6533" y="62.3638">1. Start aggregator creation</text></g><g class="message" data-entity-1="part5" data-entity-2="part2" id="msg2"><polygon fill="#181818" points="122.6533,92.5625,112.6533,96.5625,122.6533,100.5625,118.6533,96.5625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="116.6533" x2="820.7085" y1="96.5625" y2="96.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179.2007" x="128.6533" y="91.4966">1.1 Return flow parameters</text></g><g class="message" data-entity-1="part2" data-entity-2="part3" id="msg3"><polygon fill="#181818" points="313.9561,121.6953,323.9561,125.6953,313.9561,129.6953,317.9561,125.6953" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="111.6533" x2="319.9561" y1="125.6953" y2="125.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="149.8174" x="118.6533" y="120.6294">2. Redirect to IDP login</text></g><g class="message" data-entity-1="part3" data-entity-2="part6" id="msg4"><polygon fill="#181818" points="336.9561,150.8281,326.9561,154.8281,336.9561,158.8281,332.9561,154.8281" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="1021.396,150.8281,1031.396,154.8281,1021.396,158.8281,1025.396,154.8281" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="330.9561" x2="1027.396" y1="154.8281" y2="154.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="314.1709" x="342.9561" y="149.7622">2.1 Dereference Aggregator Client ID Document</text></g><g class="message" data-entity-1="part3" data-entity-2="part1" id="msg5"><polygon fill="#181818" points="45.3809,179.9609,35.3809,183.9609,45.3809,187.9609,41.3809,183.9609" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="313.9561,179.9609,323.9561,183.9609,313.9561,187.9609,317.9561,183.9609" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="39.3809" x2="319.9561" y1="183.9609" y2="183.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="184.3296" x="51.3809" y="178.895">3. Authenticate and consent</text></g><g class="message" data-entity-1="part3" data-entity-2="part2" id="msg6"><polygon fill="#181818" points="122.6533,209.0938,112.6533,213.0938,122.6533,217.0938,118.6533,213.0938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="116.6533" x2="324.9561" y1="213.0938" y2="213.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190.3027" x="128.6533" y="208.0278">4. Redirect with code + state</text></g><g class="message" data-entity-1="part2" data-entity-2="part5" id="msg7"><polygon fill="#181818" points="809.7085,238.2266,819.7085,242.2266,809.7085,246.2266,813.7085,242.2266" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="111.6533" x2="815.7085" y1="242.2266" y2="242.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="241.7061" x="118.6533" y="237.1606">5. Return code + redirect_uri + state</text></g><g class="message" data-entity-1="part5" data-entity-2="part4" id="msg8"><polygon fill="#181818" points="495.2549,267.3594,485.2549,271.3594,495.2549,275.3594,491.2549,271.3594" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="809.7085,267.3594,819.7085,271.3594,809.7085,275.3594,813.7085,271.3594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="489.2549" x2="815.7085" y1="271.3594" y2="271.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="313.4536" x="501.2549" y="266.2935">5.1 Dereference Application Client ID Document</text></g><path d="M743,284.3594 L743,309.3594 L898,309.3594 L898,294.3594 L888,284.3594 L743,284.3594" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M888,284.3594 L888,294.3594 L898,294.3594 L888,284.3594" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.9512" x="749" y="301.4263">validate redirect_uri.</text><g class="message" data-entity-1="part5" data-entity-2="part3" id="msg9"><polygon fill="#181818" points="336.9561,331.625,326.9561,335.625,336.9561,339.625,332.9561,335.625" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="330.9561" x2="820.7085" y1="335.625" y2="335.625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.2324" x="342.9561" y="330.5591">5.2 Redeem code</text></g><g class="message" data-entity-1="part3" data-entity-2="part5" id="msg10"><polygon fill="#181818" points="809.7085,360.7578,819.7085,364.7578,809.7085,368.7578,813.7085,364.7578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="325.9561" x2="815.7085" y1="364.7578" y2="364.7578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252.6748" x="332.9561" y="359.6919">IDP_aggregator_token + refresh_token</text></g><g class="message" data-entity-1="part5" data-entity-2="part2" id="msg11"><polygon fill="#181818" points="122.6533,389.8906,112.6533,393.8906,122.6533,397.8906,118.6533,393.8906" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2,2;" x1="116.6533" x2="820.7085" y1="393.8906" y2="393.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="248.6821" x="128.6533" y="388.8247">5.3 Return aggregator account details</text></g><?plantuml-src VLAzQiCm4Dxz58VN4aEIPWcbKEebMsde78HySKGKoSXoGhSEtKgXVnGwPIdq8VesVO8yGa_-Ynn8XZYolv-xJtVvKgYC6RO2Ubh1HSQKdTfxYM2GMwPIYK7WON2Nem6MGrWUTjklfx23Nqk1zESOzN6t_NdzUtZURTz-kzHm4jyG-l4IEZgzTD6hB9E2CokqQbmdCSIQ5wlAzlsn51AlWWawS4XJWocpsi0KpRhiz_kp4hNGKSd9cYrjNpge1RrB3nv3FuAffHB0zjRSO9ahyChrI5SvE4qVRj4MHi5SwWsK8qAB9lUhq8sDOH0HCn5kMc2r-mPIfq85xdJHwQLjrQdw4AF1EVqKHpWPkxLo8n_3C8AhmYu8SDD1O2e1hbNUCFqWvrvt6s4NH4mGpY2tf3nsOwEe2L-pJMqnAunenLxBPKnl2vp5GRwJknGeJJcqMn2_ZpMJ8d49_VfHPsRr44RHmEL4N9KjjzVWkz6tsNu5PbOlKPNPvWRpHVKU75k8KJHixiHR8yQvBYXAWfO9cVy3?></g></svg>